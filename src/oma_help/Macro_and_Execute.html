<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    
    <meta name="Generator" content="iWeb 2.0.3" />
    <meta name="iWeb-Build" content="local-build-20080211" />
    <meta name="viewport" content="width=720" />
    <title>Grouping OMA Commands: Macro and Execute</title>
    <link rel="stylesheet" type="text/css" media="screen,print" href="Macro_and_Execute_files/Macro_and_Execute.css" />
    <!--[if IE]><link rel='stylesheet' type='text/css' media='screen,print' href='Macro_and_Execute_files/Macro_and_ExecuteIE.css'/><![endif]-->
    <script type="text/javascript" src="Scripts/iWebSite.js"></script>
    <script type="text/javascript" src="Scripts/Widgets/SharedResources/WidgetCommon.js"></script>
    <script type="text/javascript" src="Scripts/Widgets/Navbar/navbar.js"></script>
    <script type="text/javascript" src="Macro_and_Execute_files/Macro_and_Execute.js"></script>
  </head>
  <body style="background: #ffffff; margin: 0pt; " onload="onPageLoad();" onunload="onPageUnload();">
    <div style="text-align: center; ">
      <div style="margin-bottom: 0px; margin-left: auto; margin-right: auto; margin-top: 0px; overflow: hidden; position: relative; word-wrap: break-word;  background: #ffffff; text-align: left; width: 720px; " id="body_content">
        <div style="float: left; height: 0px; line-height: 0px; margin-left: 0px; position: relative; width: 720px; z-index: 10; " id="header_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
        </div>
        <div style="margin-left: 0px; position: relative; width: 720px; z-index: 0; " id="nav_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
          <div class="com-apple-iweb-widget-navbar flowDefining" id="widget0" style="margin-left: 35px; margin-top: 0px; position: relative; width: 630px; z-index: 1; ">
    
            <div id="widget0-navbar" class="navbar">

      
              <div id="widget0-bg" class="navbar-bg">

        
                <ul id="widget0-navbar-list" class="navbar-list">
 <li></li> 
</ul>
                
      
</div>
              
    
</div>
          </div>
          <script type="text/javascript"><!--//--><![CDATA[//><!--
new NavBar('widget0', 'Scripts/Widgets/Navbar', 'Scripts/Widgets/SharedResources', '.', {"current-page-GUID": "B3E36899-A38B-48BD-BA8E-34B7EF0B9B33", "path-to-root": "", "isCollectionPage": "NO", "navbar-css": ".navbar {\n\tfont-family: Arial, sans-serif;\n\tfont-size: 1em;\n\tcolor: #666;\n\tmargin: 9px 0px 6px 0px;\n\tline-height: 30px;\n}\n\n.navbar-bg {\n\ttext-align: center;\n}\n\n.navbar-bg ul {\n\tlist-style: none;\n\tmargin: 0px;\n\tpadding: 0px;\n}\n\n\nli {\n\tlist-style-type: none;\n\tdisplay: inline;\n\tpadding: 0px 10px 0px 10px;\n}\n\n\nli a {\n\ttext-decoration: none;\n\tcolor: #666;\n}\n\nli a:visited {\n\ttext-decoration: none;\n\tcolor: #666;\n}\n\nli a:hover\r{\r\n \tcolor: #463C3C;\n\ttext-decoration: none;\r}\n\n\nli.current-page a\r{\r\t color: #463C3C;\n\ttext-decoration: none;\n\tfont-weight: bold;\r\r}"});
//--><!]]></script>
          <div style="clear: both; height: 0px; line-height: 0px; " class="spacer"> </div>
        </div>
        <div style="margin-left: 0px; position: relative; width: 720px; z-index: 5; " id="body_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
          <div style="height: 1px; line-height: 1px; " class="tinyText"> </div>
          <div style="margin-left: 35px; margin-top: 106px; position: relative; width: 630px; z-index: 1; " class="style_SkipStroke flowDefining">
            <div class="text-content style_External_630_2932" style="padding: 0px; ">
              <div class="style">
                <p style="padding-top: 0pt; " class="paragraph_style">; comment<br /></p>
                <p class="paragraph_style">    The semicolon is used to add comments to OMA commands. This can follow the last numeric argument on a command line or can be used at the beginning of a line. For example, a macro might have lines like this:<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">    + @offset    ; the value stored in the variable “offset” will be added to each pixel <br /></p>
                <p class="paragraph_style">    ; now display the result (the window title will be “the result”)<br /></p>
                <p class="paragraph_style">    d the result<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">    Note that adding the “; comment” at the end of a command that expects a string or filename argument will include “; comment” as part of the string or filename.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">DMACRO [n] [command]<br /></p>
                <p class="paragraph_style">    Prompts the user for lines of a command macro to be executed using the RMACRO command. If the argument n is omitted, definition starts with line one. If n is specified, definition begins with the nth line of the macro. To include numerical arguments that change each time the macro is executed, %d can be inserted in the macro command at the location where the number will be placed upon execution of the macro. If “command” is not present, the program prompts for additional command lines until a null command is entered (i.e. &lt;CR&gt; only). If the optional “command” is included on the same line, the text of “command” replaces any command already existing at line n and no further command lines are solicited. Dummy arguments in Macros or Execute files include the following:<br /></p>
                <p class="paragraph_style">    %c  the number of seconds since OMA was started (float)<br /></p>
                <p class="paragraph_style">    %d  a decimal digit<br /></p>
                <p class="paragraph_style">    %s  the string specified by the STRMAC command<br /></p>
                <p class="paragraph_style">    %f  last file name<br /></p>
                <p class="paragraph_style">    %b  maximum value (big)<br /></p>
                <p class="paragraph_style">    %l  minimum value (little)<br /></p>
                <p class="paragraph_style">    %m  multiplier (the current scale factor)<br /></p>
                <p class="paragraph_style">    %t  current date and time<br /></p>
                <p class="paragraph_style">    %v  an integer value that increments by a specified amount every time it is used<br /></p>
                <p class="paragraph_style">    Use the VALMAC command to specify the starting value and increment.<br /></p>
                <p class="paragraph_style">    %e  the result of the last error code (0 means no error)<br /></p>
                <p class="paragraph_style">    %a  the average within the currently defined rectangle<br /></p>
                <p class="paragraph_style">    %r  the rms within the currently defined rectangle<br /></p>
                <p class="paragraph_style">    %h  the height of the current image<br /></p>
                <p class="paragraph_style">    %w  the width of the current image<br /></p>
                <p class="paragraph_style">    %x  the x pixel coordinate of the last mouse click<br /></p>
                <p class="paragraph_style">    %y  the y pixel coordinate of the last mouse click<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">ECHO string<br /></p>
                <p class="paragraph_style">    Prints “string” during macro execution. “string” can be replaced with any of the macro dummy arguments (e.g., ECHO %b).<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">ENDIF<br /></p>
                <p class="paragraph_style">    Terminates an IF command. This is applicable within Macros only.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">EXECUTE &lt;filename&gt;<br /></p>
                <p class="paragraph_style">    Reads OMA commands stored in the specified file into a special execute buffer and then performs those commands. Unlike macros, these should not contain dummy numerical arguments (%d).<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">FCLOSE<br /></p>
                <p class="paragraph_style">    Closes the currently open text file (there can be only one). The use of FOPEN, FCLOSE, and FECHO allows derived values to be written to a file from within a macro.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">FECHO %s<br /></p>
                <p class="paragraph_style">    Exactly as echo but instead of printing to the command window, it writes to the file opened with FOPEN. The use of FOPEN, FCLOSE, and FECHO allows derived values to be written to a file from within a macro.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">FOPEN &lt;filename&gt;<br /></p>
                <p class="paragraph_style">    Open a text file with the name &lt;filename&gt; for I/O. The use of FOPEN, FCLOSE, and FECHO allows derived values to be written to a file from within a macro.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">GMACRO &lt;filename&gt;<br /></p>
                <p class="paragraph_style">    Loads the contents of the specified file into the current macro buffer.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">IF condition<br /></p>
                <p class="paragraph_style">    If condition evaluates to a non-zero value, the commands following the IF are executed. However, if the condition is zero, the commands between IF and ENDIF are not executed. The condition can be any arithmetic statement and can include logical operators &lt; (less than), &gt; (greater than), others to come....<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">IFEXST &lt;filename&gt;<br /></p>
                <p class="paragraph_style">    If the specified filename exists, the condition is satisfied, and the macro commands following the IFEXST command will be executed. <br /></p>
                <p class="paragraph_style">    Note: the SAVE prefix and suffix are applied to the filename before the test is done.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">IFNEXS &lt;filename&gt;<br /></p>
                <p class="paragraph_style">    If the specified filename does not exist, the condition is satisfied, and the macro commands following the IFNEXS command will be executed. <br /></p>
                <p class="paragraph_style">    Note: the SAVE prefix and suffix are applied to the filename before the test is done.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">IFDEFINED variable_name<br /></p>
                <p class="paragraph_style">    If the specified variable_name is defined, the condition is satisfied, and the macro commands following the IFDEF command will be executed.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">IFNDEFINED variable_name<br /></p>
                <p class="paragraph_style">    If the specified variable_name is not defined, the condition is satisfied, and the macro commands following the IFNDEF command will be executed.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">IMACRO n<br /></p>
                <p class="paragraph_style">    Used for setting or clearing a flag which determines whether or not an executing macro can be interrupted (using “cmd .”). If n = 0, interruption is not allowed. If n is non-0, it is. This can be used from within a macro to ensure that certain sequences of commands are complete before stopping the macro. (e.g., to be sure that the camera shutter is closed.)<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">INCMACRO n <br /></p>
                <p class="paragraph_style">    Specifies that on each execution of a macro, values should be incremented by value n.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">LMACRO <br /></p>
                <p class="paragraph_style">    Lists the contents in the current macro buffer.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">LOOP variable_name start end [step]<br /></p>
                <p class="paragraph_style">    Initializes a loop. The variable_name can be any string of reasonable length. The variable takes on the initial value specified by “start” and the commands within the loop are repeated until the variable is &gt;= “end”. ( or &lt;= “end” if step &lt; 0) If step is not specified, a step of 1 is assumed. The end of the loop is specified by the LOOPND command. Each LOOP must have a corresponding LOOPND. To access the value of a loop variable, precede variable_name with “@” For example:<br /></p>
                <p class="paragraph_style">    loop fnum 2 10 2<br /></p>
                <p class="paragraph_style">    get data@fnum<br /></p>
                <p class="paragraph_style">    disp<br /></p>
                <p class="paragraph_style">    loopnd<br /></p>
                <p class="paragraph_style">    .<br /></p>
                <p class="paragraph_style">    .<br /></p>
                <p class="paragraph_style">    Note: To signify the end of a variable name when it is followed by other characters, use a '\' character. For example:<br /></p>
                <p class="paragraph_style">    loop fnum 2 10 2<br /></p>
                <p class="paragraph_style">    get data@fnum\_corrected<br /></p>
                <p class="paragraph_style">    disp<br /></p>
                <p class="paragraph_style">    loopnd<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">LOOPBREAK<br /></p>
                <p class="paragraph_style">    Break out of current loop.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">LOOPND<br /></p>
                <p class="paragraph_style">    Specifies the end of a loop initiated with the LOOP command.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">MACRO [n m]<br /></p>
                <p class="paragraph_style">    Like “RMACRO [n m]” except that printing of intermediate output is automatically suppressed.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">PAUSE [pause_string]<br /></p>
                <p class="paragraph_style">    When executed in a macro, the PAUSE command causes macro execution to be suspended until a key on the keyboard is pressed, at which time the macro will continue execution. If the optional pause_string is included, it will be echoed to the right of the Macro # in the status window. The pause_string can contain variable names or %d type dummy arguments that will be filled in before echoing the string. To terminate a paused macro, type &lt;cmnd period&gt;.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">PMACRO n <br /></p>
                <p class="paragraph_style">    Executes commands in the current macro buffer with “%d”s being replaced by the value n.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">RMACRO [n m] <br /></p>
                <p class="paragraph_style">    Starts executing commands in the macro buffer with %d being replaced first by value n. Subsequently, n is incremented by the amount specified in the INCMACRO command (default is 1). If the new numeric value is equal to m, the macro will be executed again. Menu items can be selected and the appropriate commands executed during macros. Commands typed during the execution of a macro will be echoed to the terminal but not performed. To stop a macro during execution type “cmd .” (hold down the apple key and type “.”)<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">SMACRO <br /></p>
                <p class="paragraph_style">    Saves the contents of the current macro buffer to a specified file. SMACRO is also used to save commands to be used with the EXECUTE command.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">STRMACRO string<br /></p>
                <p class="paragraph_style">    Specifies that “string” is to be substituted for any “%s” found in macro or execute commands. If no string is specified, the current string is printed.<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style">VALMACRO [Startval Incval]<br /></p>
                <p class="paragraph_style">    Resets the %v value to “Startval” (0 is default) with an increment of “Incval”<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="paragraph_style"><br /></p>
              </div>
              <div style="height: 17px; line-height: 17px; " class="tinyText"> </div>
            </div>
          </div>
          


          <div id="id1" style="height: 91px; left: 35px; position: absolute; top: 22px; width: 630px; z-index: 1; " class="style_SkipStroke_1">
            <div class="text-content graphic_shape_layout_style_default_External_630_91" style="padding: 0px; ">
              <div class="graphic_shape_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="Title">Grouping OMA Commands: Macro and Execute</p>
              </div>
            </div>
          </div>
          


          <div style="height: 1px; width: 630px;  height: 0px; left: 35px; position: absolute; top: 1px; width: 630px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 630px; ">
              <img src="Macro_and_Execute_files/shapeimage_1.jpg" alt="" style="height: 1px; left: 0px; position: absolute; top: 0px; width: 630px; " />
            </div>
          </div>
          <div style="height: 0px; line-height: 0px; " class="spacer"> </div>
        </div>
        <div style="height: 150px; margin-left: 0px; position: relative; width: 720px; z-index: 15; " id="footer_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
        </div>
      </div>
    </div>
  </body>
</html>


